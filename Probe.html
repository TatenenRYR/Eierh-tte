<!DOCTYPE html><html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>HÃ¼tten Assistent â€“ Neue OberflÃ¤che</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <style>
    body { font-family: sans-serif; }
    .sidebar-btn:hover { background-color: #10b981; color:white; }
    .card-option { transition: transform 0.2s, box-shadow 0.2s; }
    .card-option:hover { transform: translateY(-3px); box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
    .selected { border:2px solid #10b981; background-color:#ecfdf5; }
  </style>
</head>
<body class="bg-gray-100">
<div class="flex min-h-screen">  <!-- Sidebar (mobile toggle) -->  <div id="sidebar" class="fixed md:static inset-y-0 left-0 w-60 bg-white border-r p-4 flex flex-col gap-3 transform -translate-x-full md:translate-x-0 transition-transform z-50">
    <div class="text-2xl font-bold text-green-700 mb-6">ğŸŒ¿ Assistent</div>
    <button class="sidebar-btn flex items-center gap-2 p-2 rounded" onclick="showMyEntries()">ğŸ“‹ Meine Eintragungen</button>
    <button class="sidebar-btn flex items-center gap-2 p-2 rounded" onclick="startNewEntry()">â• Neue Eintragung</button>
    <button class="sidebar-btn flex items-center gap-2 p-2 rounded" onclick="openSupport()">ğŸ’¬ Support</button>
    <div class="mt-auto text-xs text-gray-400">v0.3 Prototype</div>
  </div>  <!-- Main Content -->  <div class="flex-1 flex flex-col">
    <!-- Topbar for mobile -->
    <div class="md:hidden flex items-center justify-between bg-white border-b p-3">
      <div class="font-bold text-green-700">Assistent</div>
      <button onclick="toggleSidebar()" class="p-2 bg-green-600 text-white rounded">â˜°</button>
    </div><!-- Progressbar -->
<div class="w-full h-2 bg-gray-200">
  <div id="progress" class="h-2 bg-green-500 w-0 transition-all"></div>
</div>

<!-- Question Area -->
<div id="question-area" class="flex-1 flex flex-col items-center justify-center p-6 overflow-y-auto">
</div>

<!-- Navigation Buttons fixed bottom -->
<div class="fixed bottom-0 left-60 md:left-60 right-0 flex justify-between p-4 border-t bg-white">
  <button id="backBtn" class="px-4 py-2 bg-gray-200 rounded" onclick="prevStep()">â¬…ï¸ ZurÃ¼ck</button>
  <button id="nextBtn" class="px-4 py-2 bg-green-600 text-white rounded" onclick="nextStep()">Weiter â¡ï¸</button>
</div>

  </div>
</div><script>
const firebaseConfig = { /* dein Firebase Config */ };
const app = firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

let currentUser = { uid: "demo" };
let editingData = {};
let step = 0;
const totalSteps = 9;

function saveField(field, value) {
  editingData[field] = value;
  editingData.step = step;
}

function updateProgress() {
  const percent = ((step) / totalSteps) * 100;
  document.getElementById("progress").style.width = percent + "%";
}

function renderQuestion() {
  const qa = document.getElementById("question-area");
  qa.innerHTML = "";

  switch(step) {
    case 0:
      qa.innerHTML = `<div class="bg-white p-6 rounded-xl shadow max-w-lg w-full">
        <h2 class="text-xl font-bold mb-4">ğŸ›¡ï¸ DatenschutzerklÃ¤rung</h2>
        <p class="mb-4">Bitte bestÃ¤tige, dass du die DatenschutzerklÃ¤rung akzeptierst.</p>
        <label class="flex items-center gap-2">
          <input type="checkbox" id="dsCheck" /> Ich akzeptiere
        </label></div>`;
      break;
    case 1:
      qa.innerHTML = `<h2 class='text-xl font-bold mb-6'>Was mÃ¶chtest du eintragen?</h2>`;
      const opts = ["ğŸ¥š EierhÃ¼tte","ğŸª Hofladen","ğŸ¤– SelbstbedienungshÃ¤uschen","ğŸ› Spielplatz","ğŸŒ„ Abenteuerhof"];
      const wrap = document.createElement("div");
      wrap.className = "grid grid-cols-1 md:grid-cols-2 gap-4 w-full max-w-2xl";
      opts.forEach(opt => {
        const card = document.createElement("div");
        card.className = "card-option bg-white p-6 rounded-xl shadow cursor-pointer text-center";
        card.innerHTML = `<div class='text-3xl mb-2'>${opt.split(" ")[0]}</div><div class='font-semibold'>${opt.substring(2)}</div>`;
        card.onclick = () => {
          document.querySelectorAll(".card-option").forEach(c=>c.classList.remove("selected"));
          card.classList.add("selected");
          editingData.typ = opt.substring(2);
        };
        wrap.appendChild(card);
      });
      qa.appendChild(wrap);
      break;
    case 2:
      qa.innerHTML = `<div class="bg-white p-6 rounded-xl shadow max-w-lg w-full">
        <h2 class="text-xl font-bold mb-4">ğŸ·ï¸ Wie heiÃŸt deine HÃ¼tte?</h2>
        <input id="nameInput" type="text" class="w-full border p-2 rounded" placeholder="Name eingeben..." /></div>`;
      break;
    case 3:
      qa.innerHTML = `<div class="bg-white p-6 rounded-xl shadow max-w-lg w-full">
        <h2 class="text-xl font-bold mb-4">ğŸª‘ Hat deine HÃ¼tte SitzplÃ¤tze?</h2>
        <div class="flex gap-4">
          <button class="flex-1 p-4 border rounded" onclick="selectOption('sitzplaetze','Ja',this)">âœ… Ja</button>
          <button class="flex-1 p-4 border rounded" onclick="selectOption('sitzplaetze','Nein',this)">âŒ Nein</button>
        </div></div>`;
      break;
    case 4:
      qa.innerHTML = `<div class="bg-white p-6 rounded-xl shadow max-w-lg w-full">
        <h2 class="text-xl font-bold mb-4">ğŸ”Œ Gibt es Strom?</h2>
        <div class="flex gap-4">
          <button class="flex-1 p-4 border rounded" onclick="selectOption('strom','Ja',this)">âš¡ Ja</button>
          <button class="flex-1 p-4 border rounded" onclick="selectOption('strom','Nein',this)">âŒ Nein</button>
        </div></div>`;
      break;
    case 5:
      qa.innerHTML = `<div class="bg-white p-6 rounded-xl shadow max-w-lg w-full">
        <h2 class="text-xl font-bold mb-4">âœ¨ Extras?</h2>
        <input id="extrasInput" type="text" class="w-full border p-2 rounded" placeholder="z.B. GetrÃ¤nke, KÃ¼hlschrank" /></div>`;
      break;
    case 6:
      qa.innerHTML = `<div class="bg-white p-6 rounded-xl shadow max-w-lg w-full">
        <h2 class="text-xl font-bold mb-4">ğŸ¾ Welche Tiere gibt es?</h2>
        <div class="grid grid-cols-3 gap-2" id="tiereGrid"></div></div>`;
      const tiere = ["ğŸ Ziege","ğŸ„ Kuh","ğŸ“ Huhn","ğŸ• Hund","ğŸ‡ Hase","ğŸš« Keine"];
      const grid = qa.querySelector("#tiereGrid");
      editingData.tiere = editingData.tiere || [];
      tiere.forEach(t => {
        const btn = document.createElement("button");
        btn.className = "p-2 border rounded";
        btn.textContent = t;
        btn.onclick = () => {
          if (btn.classList.contains("selected")) {
            btn.classList.remove("selected");
            editingData.tiere = editingData.tiere.filter(x=>x!==t);
          } else {
            btn.classList.add("selected");
            if (t === "ğŸš« Keine") editingData.tiere = [];
            else editingData.tiere.push(t);
          }
        };
        grid.appendChild(btn);
      });
      break;
    case 7:
      qa.innerHTML = `<div class="bg-white p-6 rounded-xl shadow max-w-lg w-full">
        <h2 class="text-xl font-bold mb-4">ğŸ“ Bitte beschreibe deine HÃ¼tte kurz</h2>
        <textarea id="descInput" class="w-full border p-2 rounded" rows="3"></textarea></div>`;break;
case 8:
  qa.innerHTML = `<div class="bg-white p-6 rounded-xl shadow max-w-lg w-full">
    <h2 class="text-xl font-bold mb-4">ğŸ·ï¸ SchlagwÃ¶rter</h2>
    <input id="tagsInput" type="text" class="w-full border p-2 rounded" placeholder="z.B. FrÃ¼hstÃ¼ck, GetrÃ¤nke, schattig" /></div>`;
  break;
case 9:
  qa.innerHTML = `<div class='bg-white p-6 rounded-xl shadow w-full max-w-2xl'>
    <h2 class='text-xl font-bold mb-4'>ğŸ“‹ Ãœbersicht</h2>
    <pre class='bg-gray-100 p-2 rounded mb-4'>${JSON.stringify(editingData,null,2)}</pre>
    <div id="map" class="w-full h-64 mb-4"></div>
    <button class="px-4 py-2 bg-green-600 text-white rounded" onclick="submitEntry()">âœ… Einreichen</button>
    <p class="text-sm text-gray-500 mt-2">Deine Eintragung wird vom Admin Ã¼berprÃ¼ft und nach erfolgreicher PrÃ¼fung freigegeben.</p>
  </div>`;
  const map = L.map("map").setView([51.3,9.5], 6);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { attribution: '&copy; OpenStreetMap' }).addTo(map);
  let marker;
  map.on('click', e => {
    if (marker) map.removeLayer(marker);
    marker = L.marker(e.latlng).addTo(map);
    editingData.location = e.latlng;
  });
  break;

}

updateProgress(); }

function selectOption(field,value,el){ el.parentNode.querySelectorAll("button").forEach(b=>b.classList.remove("selected")); el.classList.add("selected"); editingData[field] = value; }

function nextStep(){ if (step===0){ if(!document.getElementById("dsCheck").checked){ alert("Bitte DatenschutzerklÃ¤rung akzeptieren"); return;} editingData.datenschutz=true; } if (step===2){ const val=document.getElementById("nameInput").value.trim(); if(!val){alert("Bitte Namen eingeben");return;} editingData.name=val; } if (step===5){ editingData.extras=document.getElementById("extrasInput").value.trim(); } if (step===7){ editingData.beschreibung=document.getElementById("descInput").value.trim(); } if (step===8){ editingData.tags=document.getElementById("tagsInput").value.split(",").map(t=>t.trim()).filter(t=>t); } step++; renderQuestion(); }

function prevStep(){ if(step>0) step--; renderQuestion(); }

function submitEntry(){ editingData.status="offen"; db.collection("eierhuetten").add(editingData).then(()=>{ alert("âœ… Eingereicht! Wird vom Admin geprÃ¼ft."); startNewEntry(); }); }

function toggleSidebar(){ document.getElementById("sidebar").classList.toggle("-translate-x-full"); }

function showMyEntries(){ db.collection('eierhuetten').where('userId','==',currentUser.uid).get().then(snap=>{ let list=""; snap.forEach(doc=>{ let d=doc.data(); list+=<li>${d.name||'Unbenannt'} â€“ ${d.status}</li>; }); document.getElementById("question-area").innerHTML=<div class='bg-white p-6 rounded-xl shadow w-full max-w-lg'><h2 class='text-xl mb-4'>Meine Eintragungen</h2><ul>${list||'<li>Keine</li>'}</ul></div>; }); toggleSidebar(); }

function openSupport(){ document.getElementById("question-area").innerHTML=<div class='bg-white p-6 rounded-xl shadow w-full max-w-lg'> <h2 class='text-xl mb-4'>Support</h2> <input id='supName' class='border p-2 w-full mb-2 rounded' placeholder='Dein Name'> <input id='supMail' class='border p-2 w-full mb-2 rounded' placeholder='Deine E-Mail'> <textarea id='supMsg' class='border p-2 w-full mb-2 rounded' rows='3' placeholder='Nachricht'></textarea> <button class='px-4 py-2 bg-green-600 text-white rounded mt-2' onclick='sendSupport()'>Absenden</button></div>; toggleSidebar(); }

function sendSupport(){ const sup={name:document.getElementById('supName').value,mail:document.getElementById('supMail').value,msg:document.getElementById('supMsg').value,time:new Date()}; db.collection('support').add(sup).then(()=>{alert('âœ… Nachricht gesendet'); startNewEntry();}); }

renderQuestion(); </script>

</body>
</html>
